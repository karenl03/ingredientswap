<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ingredient Swap</title>
<link rel="icon" href="is-logo.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Abril+Fatface&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" /><style>

    .material-symbols-outlined {
        font-size: 50px;
        color: #B4D4CA;
        margin-top: 10px;
    }

    body {
        font-family: 'Abril Fatface';
        font-weight: normal;
        width: 100%;
        margin: 0;
        padding: 0;
        background-color: #ffffff;
        display: flex;
        flex-direction: column;
    }

    h1 {
        font-family: 'Abril Fatface';
        padding: 0;
        margin: 0;
        order: 1;
    }

    h2 {
        font-family: 'Abril Fatface';
        padding: 0;
        margin: 0;
        font-size: 18px;
        order: 2;
    }

    .container {
        flex: 1;
        max-width: 90%;
        margin: 0 auto;
        padding: 10px;
        background-color: #FFF;
        border-radius: 10px;
        margin-top: 10px;
        position: relative;
        text-align: center;
    }

    .title {
        font-size: 18px;
        font-weight: bold;
        color: #F17D98;
        text-align: center;
        margin-top: 5px;
    }

    .text-title {
        font-size: 15px;
        font-weight: bold;
        color: #ffffff;
        text-align: left;
    }

    .text-box {
        font-size: 15px;
        font-family: 'Roboto', italic;
        font-weight: normal;
        color: #000000;
        text-align: left;
        margin-top: px;
    }

    header {
        background-color: #B4D4CA;
        color: #fff;
        height: 68px;
        text-align: center;
        padding: 10px 0;
    }

    footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: #fff;
        color: #fff;
        height: 50px;
        text-align: center;
        padding: 10px 0;
    }

    footer-top {
        position: fixed;
        bottom: 50px; /* Adjust to fit the size of the footer */
        width: 100%;
        background-color: #B4D4CA;
        height: 5px; /* Adjust the height of the rectangle */
        text-align: center;
        padding: 10px 0;
    }

    .footer-icons {
        display: flex;
        justify-content: space-around;
    }

    .header-icons {
        display: flex;
        justify-content: space-between;
        padding: 0 20px; 
    }

    .header-text {
        display: flex;
        flex-direction: column;
    }

    .ingredients-title {
        font-family: 'Abril Fatface';
        font-weight: normal;
        color: #000000;
        text-decoration: underline;
        text-align: left;
        margin-top: 5px;
        margin-left: 10px;
    }

    .nutrition-title {
        font-size: 12px;
        font-family: 'Abril Fatface';
        font-weight: normal;
        color: #000000;
        text-decoration: underline;
        text-align: left;
        margin-top: 5px;
        margin-left: 10px;
    }

    .nutrition-text {
        font-size: 20px;
        font-family: 'Roboto Mono', normal;
        font-weight: normal;
        color: #000000;
        text-align: left;
        margin-left: 20px;
        text-decoration: none;
        line-height: 0.75;
    }

    .save-button-container {
        position: fixed;
        bottom: 100px;
        right: 28px;
    }

    .save-button {
        font-family: 'Abril Fatface';
        font-size: 25px;
        background-color: #F17D98;
        color: #fff;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
    }

    .button:hover {
        background-color: #d84f96;
    }

    .container img {
        display: block;
        margin: 0 auto;
        border: 4px solid #B4D4CA;
    }
    .todo-list {
        list-style-type: none;
        padding: 0;
    }

    .todo-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }

    .task {
        font-size: 20px;
        font-family: 'Roboto Mono', normal;
        font-weight: normal;
    }

    .button {
        font-size: 16px;
        padding: 5px 10px;
        cursor: pointer;
        background-color: rgb(255, 255, 255);
        width: 40px; /* Set a fixed width */
        height: 30px; /* Set a fixed height */
        margin-left: 15px;
    }

    .button:hover {
        background-color: rgb(255, 255, 255);
    }

    .arrow.x-mark::before {
        content: "X";
    }

    .button-container {
        display: flex;
        align-items: center;
    }

    .number {
        margin-right: 10px;
        font-size: 22px;
        font-weight: bold;
        color: #F17D98;
        margin-left: 8px;
    }

    .modify-button-container {
        display: flex;
        align-items: center;
        margin: auto;
    }

    .sugar-button {
        font-family: 'Abril Fatface';
        font-size: 15px;
        background-color: #fff;
        color: #000;
        border: 2px solid #B4D4CA;
        padding: 10px 10px;
        margin-bottom: 5px;
        margin-left: 15px;
        margin-right: 15px;
        cursor: pointer;
    }

    .sugar-button.clicked {
    background-color: #B4D4CA;
    }

    .protein-button {
        font-family: 'Abril Fatface';
        font-size: 15px;
        background-color: #fff;
        color: #000;
        border: 2px solid #B4D4CA;
        padding: 10px 10px;
        margin-bottom: 5px;
        margin-left: 15px;
        margin-right: 15px;
        cursor: pointer;
    }

    .protein-button.clicked {
        background-color: #B4D4CA;
    }

    .fat-button {
        font-family: 'Abril Fatface';
        font-size: 15px;
        background-color: #fff;
        color: #000;
        border: 2px solid #B4D4CA;
        padding: 10px 10px;
        margin-bottom: 5px;
        margin-left: 15px;
        margin-right: 15px;
        cursor: pointer;
    }

    .fat-button.clicked {
        background-color: #B4D4CA;
    }

</style>
</head>
<body>

<header>
    <img src="is-logo.png" alt="Logo" height="68px">
</header>

<div class="title">
    <div class="header-icons">
        <a href="Welcome.html">
            <span class="material-symbols-outlined" style="font-size: 30px;">arrow_back_ios</span>
        </a>
        <div class = "header-text">
            <h1>Edit Recipe</h1>
            <h2>Click to remove an ingredient</h2>
        </div>
        <a href="#" onclick="navigateToInfo()">
            <span class="material-symbols-outlined" style="font-size: 30px;">info</span>
        </a>
    </div>
</div>

<script>
    function navigateToInfo() {
        // Navigate to the new page
        window.location.href = "Information.html";
    }
</script>

<div class="ingredients-title">
    <h2 style="margin-bottom: 0;">Ingredients</h2>
</div>


<!-- <ul class="todo-list">
    <li class="todo-item">
        <div class="button-container">
            <button class="button" onclick="toggleState(this)"></button>
            <span class="number">1</span>
        </div>
        <span class="task">Eggs</span>
    </li>
    <li class="todo-item">
        <div class="button-container">
            <button class="button" onclick="toggleState(this)"></button>
            <span class="number">2</span>
        </div>
        <span class="task">Cup Almond Milk</span>
    </li>
    <li class="todo-item">
        <div class="button-container">
            <button class="button" onclick="toggleState(this)"></button>
            <span class="number">3</span>
        </div>
        <span class="task">Cup Sugar</span>
    </li>
    <li class="todo-item">
        <div class="button-container">
            <button class="button" onclick="toggleState(this)"></button>
            <span class="number">4</span>
        </div>
        <span class="task">Cup Chocolate Chips</span>
    </li>
    <li class="todo-item">
        <div class="button-container">
            <button class="button" onclick="toggleState(this)"></button>
            <span class="number">5</span>
        </div>
        <span class="task">Tbs Baking Soda</span>
    </li>
</ul> -->

<ul class="todo-list" id="recipeList">
    <!-- List items will be generated dynamically -->
</ul>

<div class="nutrition-title">
    <h1>Nutrition</h1>
</div>

    <div class ="nutrition-text">
        <p>10g Fat</p>
        <p>5g Protein</p>
        <p>15g Sugar</p>
        <p>200 Calories</p>
    </div>


<div class="modify-button-container">
    <button class="sugar-button" onclick="modifySugar(this)">Low Sugar</button>
    <button class="protein-button" onclick="modifyProtein(this)">High Protein</button>
    <button class="fat-button" onclick="modifyFat(this)">Low Fat</button>
</div>

<script>
    // modify recipe based on saved allergens 
    // Retrieve selected allergens from local storage
    const savedAllergens = localStorage.getItem('selectedAllergens');

    // Sample recipe object
const recipe = {
    name: "Sample Recipe",
    ingredients: [
        { number: 1, task: "Eggs" },
        { number: 2, task: "Milk" },
        { number: 3, task: "Sugar" },
        { number: 4, task: "Chocolate Chips" },
        { number: 5, task: "Baking Soda" }
    ]
};

    // Define replacement rules based on allergens
    const replacementRules = {
    "Milk": "Almond Milk",
    "Eggs": "Flax Eggs",
    "Peanuts": "Almonds", 
    "Tree Nuts": "Sunflower Seeds",
    // Add more rules as needed
};

// If there are saved allergens, parse the JSON string and modify ingredients
if (savedAllergens) {
    const selectedAllergens = JSON.parse(savedAllergens);

    // Iterate over each allergen
    selectedAllergens.forEach(allergen => {
        // Modify ingredients based on allergens
        recipe.ingredients.forEach(ingredient => {
            // Check if ingredient needs to be replaced based on allergen
            if (replacementRules[allergen] && ingredient.task === allergen) {
                ingredient.task = replacementRules[allergen]; // Update the ingredient task
                ingredient.modified = true; 
            }
        });
    });
}

// Log the modified recipe with replaced ingredients
console.log("Modified Recipe:", recipe);
</script>

<script>
// Function to generate list items from recipe object
function generateRecipeList(recipe) {
    const recipeList = document.getElementById('recipeList');

    // Clear existing list items
    recipeList.innerHTML = '';

    // Generate list items for each ingredient
    recipe.ingredients.forEach(ingredient => {
        const listItem = document.createElement('li');
        listItem.className = 'todo-item';

        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';

        const button = document.createElement('button');
        button.className = 'button';
        button.setAttribute('onclick', 'toggleState(this)');

        const spanNumber = document.createElement('span');
        spanNumber.className = 'number';
        spanNumber.textContent = ingredient.number;

        const spanTask = document.createElement('span');
        spanTask.className = 'task';
        spanTask.textContent = ingredient.task;

        // Check if ingredient has been modified, and underline it if necessary
        if (ingredient.modified) {
            spanTask.style.textDecoration = 'underline';
        }

        buttonContainer.appendChild(button);
        buttonContainer.appendChild(spanNumber);
        listItem.appendChild(buttonContainer);
        listItem.appendChild(spanTask);

        recipeList.appendChild(listItem);
    });
}

// Call the function to generate the recipe list
generateRecipeList(recipe);
</script>

<script>
    function modifySugar(button) {
        button.classList.toggle('clicked');
        // Save the state of the button click
        const isClicked = button.classList.contains('clicked');
        localStorage.setItem('sugarClicked', isClicked);
    }
</script>

<script>
    function modifyProtein(button) {
        button.classList.toggle('clicked');
        // Save the state of the button click
        const isClicked = button.classList.contains('clicked');
        localStorage.setItem('proteinClicked', isClicked);
    }
</script>

<script>
    function modifyFat(button) {
        button.classList.toggle('clicked');
        // Save the state of the button click
        const isClicked = button.classList.contains('clicked');
        localStorage.setItem('fatClicked', isClicked);
    }
</script>


<script>
    function toggleState(button) {
        if (button.innerText === '') {
            button.innerText = 'X'; // Down arrow
        } 
        else {
            button.innerText = '';
        }
    }
</script>

<script>
    // Retrieve the saved state of the buttons
const sugarClicked = localStorage.getItem('sugarClicked');
const proteinClicked = localStorage.getItem('proteinClicked');
const fatClicked = localStorage.getItem('fatClicked');

// Define replacement rules based on button clicks
const replacementRules2 = {
    "Sugar": "Honey",
    "Flour": "Protein Powder",
    "Butter": "Apple Sauce", 
    // Add more rules as needed
};

// Modify the recipe based on button clicks
if (sugarClicked === 'true') {
    recipe.ingredients.forEach(ingredient => {
        if (ingredient.task === 'Sugar') {
            ingredient.task = replacementRules2['Sugar'];
        }
    });
}

if (proteinClicked === 'true') {
    recipe.ingredients.forEach(ingredient => {
        if (ingredient.task === 'Flour') {
            ingredient.task = replacementRules2['Flour'];
        }
    });
}

if (fatClicked === 'true') {
    recipe.ingredients.forEach(ingredient => {
        if (ingredient.task === 'Butter') {
            ingredient.task = replacementRules2['Butter'];
        }
    });
}
</script>

<div class="save-button-container">
    <button class="save-button" onclick="saveAndNavigate()">Save</button>
</div>

<script>
    function saveAndNavigate() {
        // Save the modified recipe to localStorage
        localStorage.setItem('modifiedRecipe', JSON.stringify(recipe));
        window.location.href = "FinalRecipe.html";
    }
</script>

<footer-top></footer-top>
<footer>
    <div class="footer-icons">
        <span class="material-symbols-outlined">home</span>
        <span class="material-symbols-outlined">bookmark</span>
        <span class="material-symbols-outlined">person</span>
    </div>
</footer>

<!-- We used ChatGPT to help when we got stuck with Javascript for the buttons and finding the right CSS modifiers -->

</body>
</html>
